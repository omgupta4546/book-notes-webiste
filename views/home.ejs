<%- include('partials/header.ejs') %>


<div class="container">
    <h1>My Book Notes</h1>
<a href="/add-book" class="add-button">Add New Book</a>
<hr>
    <div class="books-container">
    <% if (books.length > 0) { %>
        <% books.forEach(book => { %>
            <div class="book-entry">
                <h2><%= book.title %></h2>
                <p><strong>Author:</strong> <%= book.author %></p>
                <p><strong>Rating:</strong> <%= book.rating %></p>
                <p><strong>Read on:</strong> <%= book.read_date.toDateString() %></p>
                <p><strong>Notes:</strong> <%= book.notes %></p>
                <img src="https://covers.openlibrary.org/b/isbn/<%= book.isbn %>-M.jpg" alt="Cover for <%= book.title %>" class="book-cover">
                <div class="action-buttons"><a href="/edit/<%= book.book_id %>">Edit</a> <form action="/delete/<%= book.book_id %>" method="POST" style="display:inline;">
            <button type="submit">Delete</button>
        </form></div>
               
            </div>
        <% }); %>
    <% } else { %>
        <p>No books added yet. Start by adding one!</p>
    <% } %>
</div>
</div>

<script>
    async function deleteBook(id) {
        if (confirm("Are you sure you want to delete this book?")) {
            try {
                const response = await fetch(`/delete/${id}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    location.reload(); // Page ko refresh kar dein
                } else {
                    alert('Failed to delete the book.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred.');
            }
        }
    }
</script>
<%- include('partials/footer.ejs') %>